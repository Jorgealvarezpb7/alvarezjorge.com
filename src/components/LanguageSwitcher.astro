---
import type { Language } from '../i18n';

interface Props {
  currentLang: Language;
}

const { currentLang } = Astro.props;
---

<div class="language-switcher relative">
  <button
    id="lang-toggle"
    class="flex items-center gap-2 px-3 py-2 rounded-lg bg-neutral/10 hover:bg-neutral/20 transition-colors text-neutral hover:text-white border border-neutral/20"
    aria-label="Change language"
  >
    <span class="text-sm font-medium">
      {currentLang === 'en' ? 'ğŸ‡ºğŸ‡¸ EN' : 'ğŸ‡ªğŸ‡¸ ES'}
    </span>
    <svg class="w-3 h-3 transition-transform" id="lang-arrow" fill="currentColor" viewBox="0 0 20 20">
      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
    </svg>
  </button>
  
  <div id="lang-menu" class="absolute right-0 top-12 mt-1 py-2 w-32 bg-black/95 backdrop-blur-sm border border-neutral/20 rounded-lg shadow-lg hidden z-10">
    <a
      href="/"
      class="block px-4 py-2 text-sm text-neutral hover:text-white hover:bg-neutral/20 transition-colors flex items-center gap-2"
    >
      ğŸ‡ºğŸ‡¸ English
    </a>
    <a
      href="/es"
      class="block px-4 py-2 text-sm text-neutral hover:text-white hover:bg-neutral/20 transition-colors flex items-center gap-2"
    >
      ğŸ‡ªğŸ‡¸ EspaÃ±ol
    </a>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const toggleButton = document.getElementById('lang-toggle');
    const menu = document.getElementById('lang-menu');
    const arrow = document.getElementById('lang-arrow');
    
    if (toggleButton && menu && arrow) {
      toggleButton.addEventListener('click', (e) => {
        e.stopPropagation();
        menu.classList.toggle('hidden');
        arrow.classList.toggle('rotate-180');
      });
      
      document.addEventListener('click', (e) => {
        if (!toggleButton.contains(e.target as Node) && !menu.contains(e.target as Node)) {
          menu.classList.add('hidden');
          arrow.classList.remove('rotate-180');
        }
      });
    }
  });
</script>